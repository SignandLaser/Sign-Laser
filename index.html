<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign and Laser</title>
  <link href="style.css" rel="stylesheet" />
  <style>
    @keyframes fade-in-up {
      from { opacity: 0; transform: translateY(30px);}
      to   { opacity: 1; transform: translateY(0);}
    }
    .fade-in-up {
      opacity: 0;
      animation: fade-in-up 0.9s cubic-bezier(.43,.7,.3,1.2) forwards;
    }
    .tab-animate { transition: background 0.34s, color 0.34s, transform 0.25s cubic-bezier(.4,2,.6,1); position: relative;}
    .tab-animate.active, .tab-animate:focus, .tab-animate:hover {
      color: #78350f!important;
      background: linear-gradient(90deg,#fef08a,#fde047);
      box-shadow: 0 2px 12px rgba(252,211,77,0.10);
      transform: scale(1.07);
    }
    .tab-animate.active::after, .tab-animate:focus::after, .tab-animate:hover::after { opacity: 1;}
    .tab-animate::after {
      content:'';
      width:70%; height:3px;
      background: #facc15;
      opacity: 0;
      border-radius: 2px;
      transition: opacity 0.35s cubic-bezier(.5,0,.2,1);
      position: absolute; left: 15%; bottom: 2px;
    }
    .product-card {
      transition: transform 0.25s cubic-bezier(.4,2,.3,1), box-shadow 0.25s cubic-bezier(.4,2,.3,1);
      box-shadow: 0 2px 16px 0 rgba(0,0,0,0.05);
      background: #f8fafc;
    }
    .product-card:hover, .product-card:focus-within {
      transform: translateY(-6px) scale(1.028);
      box-shadow: 0 8px 24px 0 rgba(16,16,32,.13), 0 1.5px 4px 0 rgba(187,156,6,.12);
      z-index:3;
    }
    .product-card.fade-in-up { opacity: 0; animation: fade-in-up 0.8s cubic-bezier(.43,.7,.3,1.2) forwards;}
    .product-card.anim-show { opacity:1; transform: none; animation: none;}
    @keyframes cart-pop {
      0%   { transform: scale(1);}
      25%  { transform: scale(1.15);}
      60%  { transform: scale(0.93);}
      80%  { transform: scale(1.02);}
      100% { transform: scale(1);}
    }
    .cart-btn-pop { animation: cart-pop .33s cubic-bezier(.19, 2, .44, 1) 1;}
  </style>
</head>
<body class="bg-gray-100 text-gray-900 font-sans pt-24">

<header class="flex justify-between items-center px-4 py-3 bg-white shadow fixed w-full top-0 z-50 fade-in-up" style="animation-delay:.08s;">
  <div class="flex items-center space-x-3">
    <img src="logo.png" alt="Logo" class="h-20 w-auto">
    <div class="text-2xl font-bold text-slate-800" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
  Sign & Laser
</div>
  </div>
  <nav class="hidden md:flex items-center space-x-8 font-semibold text-gray-700">
    <a href="#" onclick="location.reload();" class="hover:text-yellow-500">Home</a>
    <a href="#products" class="hover:text-yellow-500">Categories</a>
    <a href="/Sign-Laser/Support" class="hover:text-yellow-500">Support</a>
    <a href="javascript:void(0);" onclick="toggleCart()" class="relative flex items-center hover:text-yellow-500">
      <span class="mr-1">Cart</span>
      <span id="header-cart-count" class="absolute -top-2 -right-3 bg-yellow-400 text-black text-xs font-semibold shadow-md rounded-full w-5 h-5 flex items-center justify-center transition cart-badge">0</span>
    </a>
    <button onclick="window.location.href='login.html'" class="ml-4 bg-yellow-500 hover:bg-yellow-600 p-2 rounded-full shadow-md flex items-center justify-center" aria-label="Login">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A8.962 8.962 0 0112 15c2.486 0 4.737.992 6.379 2.604M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
    </button>
  </nav>
  <div class="md:hidden relative">
    <button id="menu-btn" class="p-2 rounded-full hover:bg-gray-100">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <div id="mobile-menu" class="hidden absolute top-14 right-2 w-56 rounded-xl bg-white shadow-xl text-center py-4 space-y-3 z-50 transform scale-y-0 transition-transform duration-400 origin-top">
      <a href="#products" class="hover:text-yellow-500">Categories</a>
      <a href="javascript:void(0);" onclick="toggleCart()" class="relative block text-gray-800 font-medium hover:bg-gray-100 py-2 rounded">
        Cart
        <span id="mobile-cart-count" class="absolute top-1 right-4 bg-yellow-400 text-black text-xs font-semibold shadow-md rounded-full w-5 h-5 flex items-center justify-center cart-badge">0</span>
      </a>
      <a href="login.html" class="block text-yellow-600 font-medium hover:bg-yellow-100 py-2 rounded">Login</a>
    </div>
  </div>
</header>

<section class="min-h-[80vh] flex flex-col justify-center items-center text-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 text-white p-8">
  <h1 class="text-5xl md:text-6xl font-bold fade-in-up" style="animation-delay: 0.15s;">Sign and Laser</h1>
  <p class="mt-4 text-lg md:text-xl fade-in-up" style="animation-delay: 0.3s;">CNC-crafted art, d√©cor, and utility products</p>
  <a href="#products" class="mt-8 bg-yellow-500 hover:bg-yellow-600 text-black font-semibold px-6 py-3 rounded-full fade-in-up" style="animation-delay: 0.45s; box-shadow: 0 10px 24px rgba(180,180,33,.09)">View Products</a>
</section>

<div class="w-full flex flex-col items-center px-4 mb-8 fade-in-up" style="animation-delay: 0.6s;">
  <div class="relative w-full max-w-md mt-6 mb-4">
    <input id="search-input" type="text" placeholder="Search products..." class="w-full pl-12 pr-4 py-3 rounded-full border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-yellow-400 transition"/>
    <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.35-4.35M16.65 16.65A7.5 7.5 0 1010.5 18a7.5 7.5 0 006.15-3.35z" />
      </svg>
    </div>
  </div>
</div>

<section id="products" class="py-16 px-6 bg-white fade-in-up" style="animation-delay: 0.45s;">
  <h2 class="text-3xl font-semibold text-center mb-12 fade-in-up" style="animation-delay: 0.3s;">Our Creations</h2>
  <div class="flex justify-center mb-8 fade-in-up" style="animation-delay: 0.45s;">
    <div class="bg-white border border-gray-300 shadow-md rounded-full px-3 py-1 sm:px-4 sm:py-2">
      <div class="flex space-x-1 sm:space-x-2 text-sm sm:text-base font-semibold">
        <button onclick="filterProducts(event, 'all')" class="tab-animate category-btn active px-3 py-1 sm:px-5 sm:py-2 rounded-full text-gray-800">All</button>
        <button onclick="filterProducts(event, 'clocks')" class="tab-animate category-btn px-3 py-1 sm:px-5 sm:py-2 rounded-full text-gray-600">Clocks</button>
        <button onclick="filterProducts(event, 'nameboards')" class="tab-animate category-btn px-3 py-1 sm:px-5 sm:py-2 rounded-full text-gray-600">Name Boards</button>
        <button onclick="filterProducts(event, 'toppers')" class="tab-animate category-btn px-3 py-1 sm:px-5 sm:py-2 rounded-full text-gray-600">Cake Toppers</button>
      </div>
    </div>
  </div>
  <div id="loader" class="flex justify-center my-12">
    <div class="w-10 h-10 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin"></div>
  </div>
  <div id="product-error" class="text-center text-red-700 font-semibold mb-8 hidden"></div>
  <div id="dynamic-products" class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto mt-12 items-stretch"></div>
</section>

<footer class="bg-slate-700 text-white px-8 pt-12 pb-6 mt-12 fade-in-up" style="animation-delay: 0.45s;">
  <div class="max-w-screen-xl mx-auto">
    <div class="flex flex-wrap justify-between items-start space-y-8 md:space-y-0">
      <div>
        <h4 class="font-bold text-lg mb-2">Contact Us</h4>
        <p>Email: signandlaser2021@gmail.com</p>
        <p>Phone: +91 82812 57256</p>
      </div>
      <div>
        <h4 class="font-bold text-lg mb-2">Other Support</h4>
        <div class="flex space-x-4 mt-2">
          <a href="https://wa.me/918281257256" target="_blank" aria-label="WhatsApp">
            <img src="https://cdn-icons-png.flaticon.com/512/15707/15707820.png" alt="WhatsApp" class="h-8 w-8 hover:scale-110 transition-transform" />
          </a>
          <a href="https://www.instagram.com/sign_and_laser.__?igsh=dGE0eWFkMml1ZnRy" target="_blank" aria-label="Instagram">
            <img src="https://cdn-icons-png.flaticon.com/512/15707/15707749.png" alt="Instagram" class="h-8 w-8 hover:scale-110 transition-transform" />
          </a>
          <a href="https://www.facebook.com/singandlaser" target="_blank" aria-label="Facebook">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968764.png" alt="Facebook" class="h-8 w-8 hover:scale-110 transition-transform" />
          </a>
        </div>
      </div>
    </div>
    <hr class="border-t border-gray-500 my-6">
    <p class="text-sm text-center">&copy; 2025 Sign and Laser. All rights reserved.</p>
  </div>
</footer>
<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];
let cartCounts = JSON.parse(localStorage.getItem("cartCounts")) || {};
let allProducts = [];

function animateProductCards() {
  let cards = [...document.querySelectorAll('.product-card')];
  cards.forEach(c=>c.classList.remove('anim-show'));
  cards.forEach((el,i)=>{
    setTimeout(()=>el.classList.add('anim-show'), 120*i);
  });
}
function convertDriveLink(url) {
  const match = url && url.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
  return match ? `https://lh3.googleusercontent.com/d/${match[1]}=w1200` : "https://via.placeholder.com/300x200?text=Image+Missing";
}
async function fetchProducts() {
  const errorBox = document.getElementById("product-error");
  errorBox.classList.add("hidden"); errorBox.textContent = "";
  try {
    const res = await fetch("https://script.google.com/macros/s/AKfycbyx-kEMJzCx6IngTDDWaAwFLMnWobgZBCnVmENqUrGhtDwvlKsdavLwUqpEULnazsiy9g/exec");
    if (!res.ok) throw new Error("Unable to fetch products");
    const products = await res.json();
    if(!Array.isArray(products) || !products.length) throw new Error("No products found.");
    allProducts = products.map(p => ({
      ...p,
      category: p.category?.toLowerCase().trim() || 'uncategorized'
    }));
    renderProducts(allProducts, true);
  } catch(e) {
    document.getElementById("dynamic-products").innerHTML = "";
    errorBox.textContent = "Failed to load products. Please check your network or try again later.";
    errorBox.classList.remove("hidden");
  }
  document.getElementById("loader").style.display = "none";
}
function renderProducts(products, doAnimate=false) {
  const container = document.getElementById("dynamic-products");
  container.innerHTML = "";
  function escapeHTML(str) {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }
  products.forEach((p,idx) => {
    const key = p.name;
    if (cartCounts[key] === undefined) cartCounts[key] = 0;
    const count = cartCounts[key];
    const i = encodeURIComponent(key);
    container.innerHTML += `
      <div class="product-card bg-gray-50 rounded-2xl shadow-md p-6 flex flex-col h-full fade-in-up" style="animation-delay:${doAnimate?(idx*60):0}ms;">
        <img src="${convertDriveLink(p.image)}" alt="${escapeHTML(p.name)}" class="w-full h-[200px] object-cover rounded-xl" onerror="this.src='https://via.placeholder.com/300x200?text=Image+Not+Found';" />
        <div class="product-content mt-4 flex flex-col flex-1 h-full">
          <div class="flex-none">
            <h3 class="text-xl font-bold mb-2">${escapeHTML(p.name)}</h3>
            <p class="text-gray-700 mb-4">${escapeHTML(p.description)}</p>
          </div>
          <div class="mt-auto pt-2">
            <p class="text-lg font-semibold text-blue-600 mb-3">‚Çπ${p.price}</p>
            <label class="block mb-1">Buying Options:</label>
            <select id="payment-${i}" class="w-full border rounded p-2 mb-3">
              <option value="whatsapp">Order via WhatsApp</option>
              <option value="/Sign-Laser/Order?name=${i}&price=${p.price}">Order via Website</option>
              <option value="${p.amazon}">Buy on Amazon</option>
            </select>
            <div class="flex gap-2 items-center">
              <button onclick="handleOrder('payment-${i}')" class="w-[70%] bg-yellow-500 hover:bg-yellow-600 text-black px-4 py-2 rounded-full text-sm font-semibold transition">Order</button>
              <div id="cart-btn-${i}" class="w-[30%] h-10 bg-blue-600 text-white rounded-full text-sm font-semibold relative overflow-hidden flex items-center justify-center">
                ${
                  count > 0
                    ? `<div class='flex items-center justify-between h-full w-full px-2'>
                        <button type="button" onclick='changeCartQty("${key}", -1, "${i}", ${JSON.stringify(p).replace(/"/g, '&quot;')}, event)' class='text-lg font-bold'>‚àí</button>
                        <span id='count-${i}' class='text-base font-semibold'>${count}</span>
                        <button type="button" onclick='changeCartQty("${key}", 1, "${i}", ${JSON.stringify(p).replace(/"/g, '&quot;')}, event)' class='text-lg font-bold'>+</button>
                      </div>`
                    : `<div class='flex items-center justify-center h-full w-full'>
                        <button type="button" onclick='changeCartQty("${key}", 1, "${i}", ${JSON.stringify(p).replace(/"/g, '&quot;')}, event)' class='w-full h-full flex justify-center items-center'>
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.35 2.7a1 1 0 00.9 1.5H19
                                  m-12 0a1 1 0 100 2 1 1 0 000-2zm10 0a1 1 0 100 2 1 1 0 000-2z" />
                          </svg>
                        </button>
                      </div>`
                }
              </div>
            </div>
          </div>
        </div>
      </div>`;
  });
  updateCartCount();
  if(doAnimate) animateProductCards();
}

// Only update count and animate blue cart button ONCE (after updating HTML)
function changeCartQty(name, delta, id, prodJson, e) {
  if (typeof prodJson === 'string') prodJson = JSON.parse(prodJson.replace(/&quot;/g, '"'));
  cartCounts[name] = (cartCounts[name] || 0) + delta;
  if (cartCounts[name] < 0) cartCounts[name] = 0;
  let found = cart.find(p => p.name === name);
  if (delta > 0) {
    if (found) { found.qty++; }
    else {
      cart.push({ name: prodJson.name, price: prodJson.price.toString().replace(/[^\d.]/g, ""), qty: 1 });
    }
  } else if (found) {
    found.qty--;
    if (found.qty <= 0) cart.splice(cart.findIndex(p => p.name === name), 1);
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  localStorage.setItem("cartCounts", JSON.stringify(cartCounts));
  const countSpan = document.getElementById('count-' + id);
  const container = document.getElementById('cart-btn-' + id);
  if (countSpan) countSpan.textContent = cartCounts[name] > 0 ? cartCounts[name] : 0;
  if (container) {
    if (cartCounts[name] > 0) {
      container.innerHTML = `<div class='flex items-center justify-between h-full w-full px-2'>
        <button type="button" onclick='changeCartQty("${name}", -1, "${id}", ${JSON.stringify(prodJson).replace(/"/g, '&quot;')}, event)' class='text-lg font-bold'>‚àí</button>
        <span id='count-${id}' class='text-base font-semibold'>${cartCounts[name]}</span>
        <button type="button" onclick='changeCartQty("${name}", 1, "${id}", ${JSON.stringify(prodJson).replace(/"/g, '&quot;')}, event)' class='text-lg font-bold'>+</button>
      </div>`;
    } else {
      container.innerHTML = `<div class='flex items-center justify-center h-full w-full'>
        <button type="button" onclick='changeCartQty("${name}", 1, "${id}", ${JSON.stringify(prodJson).replace(/"/g, '&quot;')}, event)' class='w-full h-full flex justify-center items-center'>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.35 2.7a1 1 0 00.9 1.5H19
                  m-12 0a1 1 0 100 2 1 1 0 000-2zm10 0a1 1 0 100 2 1 1 0 000-2z" />
          </svg>
        </button>
      </div>`;
    }
    // The line below ensures pop animation triggers ONCE per click/HTML update
    container.classList.remove('cart-btn-pop');
    void container.offsetWidth;
    container.classList.add('cart-btn-pop');
  }
  updateCartCount();
}

function handleOrder(selectId) {
  const select = document.getElementById(selectId);
  const selected = select.value;
  const card = select.closest("div.product-card");
  const name = card.querySelector("h3").innerText;
  const price = card.querySelector("p.text-lg").innerText.replace("‚Çπ", "");
  const image = card.querySelector("img").src;
  if (selected === "whatsapp") {
    const message = `Hi! I'm interested in this product:\nüñºÔ∏è Product: ${name}\nüí∞ Price: ‚Çπ${price}\nüì∑ Image: ${image}`;
    window.open(`https://wa.me/918281257256?text=${encodeURIComponent(message)}`, "_blank");
  } else {
    window.open(selected, "_blank");
  }
}
function updateCartCount() {
  const count = Object.values(cartCounts || {}).reduce((sum, c) => sum + c, 0);
  document.querySelectorAll(".cart-badge").forEach(el=>{
    el.textContent = count;
  });
}
function filterProducts(event, category) {
  document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  const filtered = category === 'all' ? allProducts : allProducts.filter(p => p.category === category);
  renderProducts(filtered, true);
}
document.addEventListener("DOMContentLoaded", () => {
  fetchProducts();
  document.querySelectorAll(".category-btn").forEach(btn=>{
    btn.tabIndex = 0;
    btn.onkeydown = e=>{if(e.key===' '||e.key==='Enter')btn.click()};
  });
  const searchInput = document.getElementById("search-input");
  searchInput.addEventListener("input", function () {
    const query = this.value.toLowerCase();
    const filtered = allProducts.filter(p =>
      p.name.toLowerCase().includes(query) || p.description.toLowerCase().includes(query)
    );
    renderProducts(filtered, false);
  });
  document.getElementById("menu-btn").addEventListener("click", () => {
    let menu = document.getElementById("mobile-menu");
    if(menu.classList.contains("hidden")) {
      menu.classList.remove("hidden");
      setTimeout(()=>menu.classList.add("scale-y-100"),10);
    } else {
      menu.classList.remove("scale-y-100");
      setTimeout(()=>menu.classList.add("hidden"),400);
    }
  });
});
document.addEventListener("click", function (event) {
  const menu = document.getElementById("mobile-menu");
  const button = document.getElementById("menu-btn");
  if (!menu.classList.contains("hidden") &&
      !menu.contains(event.target) &&
      !button.contains(event.target)) {
    menu.classList.remove("scale-y-100");
    setTimeout(()=>menu.classList.add("hidden"),400);
  }
});
function toggleCart() {
  window.location.href = "/Sign-Laser/Cart";
}
</script>
<!-- BEGIN: Fixed Bottom Mobile Bar -->
<div id="mobile-bottombar"
     class="fixed bottom-4 left-0 right-0 mx-auto w-[95%] z-50 md:hidden flex items-center justify-around backdrop-blur-xl bg-white/10 border border-white/30 shadow-[inset_0_0_0.5px_rgba(255,255,255,0.2)] rounded-2xl transition-transform duration-500"
     style="height:65px;">
  
  <!-- Contact Us -->
  <a href="/Sign-Laser/Support"
     class="flex items-center justify-center h-full w-1/2">
    <div class="rounded-full p-3 bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30 shadow-sm">
      <img src="https://cdn-icons-png.flaticon.com/512/3249/3249904.png" alt="Contact Us"
        class="h-7 w-7" />
    </div>
  </a>

  <!-- Divider -->
  <div class="h-8 w-px bg-white/30 mx-4"></div>

  <!-- Cart -->
  <a href="/Sign-Laser/Cart"
     class="flex items-center justify-center h-full w-1/2">
    <div class="rounded-full p-3 bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30 shadow-sm">
      <img src="https://cdn-icons-png.flaticon.com/512/4903/4903884.png" alt="Cart"
        class="h-7 w-7" />
    </div>
  </a>
</div>

<!-- Padding space for mobile -->
<style>
@media (max-width: 767px) {
  #mobile-bottombar {
    will-change: transform, opacity;
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }
  #mobile-bottombar.hide-bar {
    transform: translateY(120%);  /* safely past all radius/shadow/blur */
    opacity: 0;
    pointer-events: none;
    transition-property: transform, opacity;
  }
  #mobile-bottombar.show-bar {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
    transition-property: transform, opacity;
  }
}
</style>

<!-- Auto-hide near footer -->
<script>
(function(){
  if(window.innerWidth > 767) return;
  let bar = document.getElementById('mobile-bottombar');
  let footer = document.querySelector('footer');
  if (!bar || !footer) return;

  // Function to add/remove bottom padding
  const togglePadding = (add) => {
    document.body.style.paddingBottom = add ? '80px' : '0px';
  };

  bar.classList.add('show-bar');
  togglePadding(true);

  let obs = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        bar.classList.remove('show-bar');
        bar.classList.add('hide-bar');
        togglePadding(false);
      } else {
        bar.classList.remove('hide-bar');
        bar.classList.add('show-bar');
        togglePadding(true);
      }
    });
  }, { threshold: 0.01 });
  obs.observe(footer);
})();
</script>



</body>
</html>
